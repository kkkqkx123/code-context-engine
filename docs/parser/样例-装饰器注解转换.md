# 装饰器/注解转换样例

## 概述

本文档展示如何将装饰器和注解转换为自然语言表示。

## 转换模板

```
Decorator {normalizedName} {docstringPart} applied to {target} {context}
```

## 样例1：函数装饰器

### 输入代码

```typescript
/**
 * Log function execution time
 */
function logExecution(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
    const originalMethod = descriptor.value;
    descriptor.value = async function (...args: any[]) {
        const start = Date.now();
        const result = await originalMethod.apply(this, args);
        const end = Date.now();
        console.log(`${propertyKey} took ${end - start}ms`);
        return result;
    };
}

@logExecution
async function processData(data: string): Promise<Result> {
    // processing logic
}
```

### 转换结果

```
Decorator Log execution that does Log function execution time applied to function process data
```

---

## 样例2：类装饰器

### 输入代码

```typescript
/**
 * Seal the class to prevent modifications
 */
function sealed(constructor: Function) {
    Object.seal(constructor);
    Object.seal(constructor.prototype);
}

@sealed
class UserService {
    // class implementation
}
```

### 转换结果

```
Decorator Sealed that does Seal the class to prevent modifications applied to class user service
```

---

## 样例3：属性装饰器

### 输入代码

```typescript
/**
 * Make property readonly
 */
function readonly(target: any, propertyKey: string) {
    Object.defineProperty(target, propertyKey, {
        writable: false
    });
}

class Config {
    @readonly
    version: string = '1.0.0';
}
```

### 转换结果

```
Decorator Readonly that does Make property readonly applied to property version
```

---

## 样例4：参数装饰器

### 输入代码

```typescript
/**
 * Validate parameter is not null
 */
function notNull(target: any, propertyKey: string, parameterIndex: number) {
    // validation logic
}

class Validator {
    validate(@notNull value: string): boolean {
        return value !== null;
    }
}
```

### 转换结果

```
Decorator Not null that does Validate parameter is not null applied to parameter value
```

---

## 样例5：方法装饰器

### 输入代码

```typescript
/**
 * Cache method results
 */
function memoize(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
    const cache = new Map();
    const originalMethod = descriptor.value;
    descriptor.value = function (...args: any[]) {
        const key = JSON.stringify(args);
        if (cache.has(key)) {
            return cache.get(key);
        }
        const result = originalMethod.apply(this, args);
        cache.set(key, result);
        return result;
    };
}

class Calculator {
    @memoize
    fibonacci(n: number): number {
        if (n <= 1) return n;
        return this.fibonacci(n - 1) + this.fibonacci(n - 2);
    }
}
```

### 转换结果

```
Decorator Memoize that does Cache method results applied to method fibonacci
```

---

## 样例6：组合装饰器

### 输入代码

```typescript
/**
 * Require authentication
 */
function requireAuth(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
    const originalMethod = descriptor.value;
    descriptor.value = function (...args: any[]) {
        if (!this.isAuthenticated()) {
            throw new Error('Unauthorized');
        }
        return originalMethod.apply(this, args);
    };
}

/**
 * Log method calls
 */
function log(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
    const originalMethod = descriptor.value;
    descriptor.value = function (...args: any[]) {
        console.log(`Calling ${propertyKey} with`, args);
        return originalMethod.apply(this, args);
    };
}

class ApiController {
    @requireAuth
    @log
    getUserData(userId: string): UserData {
        // implementation
    }
}
```

### 转换结果

```
Decorator Require auth that does Require authentication applied to method get user data
Decorator Log that does Log method calls applied to method get user data
```

---

## 样例7：注解（Java风格）

### 输入代码

```java
/**
 * Mark method as deprecated
 */
@Deprecated
public class OldService {
    /**
     * Old method, use newMethod instead
     */
    @Deprecated
    public void oldMethod() {
        // implementation
    }
}
```

### 转换结果

```
Annotation Deprecated that does Mark method as deprecated applied to class old service
Annotation Deprecated that does Mark method as deprecated applied to method old method
```

---

## 样例8：路由注解

### 输入代码

```java
/**
 * REST controller for user management
 */
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    /**
     * Get user by ID
     */
    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable String id) {
        // implementation
    }
    
    /**
     * Create new user
     */
    @PostMapping
    public ResponseEntity<User> createUser(@RequestBody User user) {
        // implementation
    }
}
```

### 转换结果

```
Annotation Rest controller that does REST controller for user management applied to class user controller
Annotation Request mapping that does Map requests to path applied to class user controller
Annotation Get mapping that does Map GET requests applied to method get user
Annotation Post mapping that does Map POST requests applied to method create user
```

---

## 样例9：依赖注入注解

### 输入代码

```java
/**
 * Service for user operations
 */
@Service
public class UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    @Transactional
    public void saveUser(User user) {
        userRepository.save(user);
    }
}
```

### 转换结果

```
Annotation Service that does Service for user operations applied to class user service
Annotation Autowired that does Autowire dependency applied to field user repository
Annotation Transactional that does Mark method as transactional applied to method save user
```

---

## 样例10：验证注解

### 输入代码

```java
public class UserDTO {
    
    @NotNull(message = "Name cannot be null")
    @Size(min = 2, max = 50)
    private String name;
    
    @Email(message = "Invalid email format")
    private String email;
    
    @Min(value = 18)
    private int age;
}
```

### 转换结果

```
Annotation Not null that does Name cannot be null applied to field name
Annotation Size that does Validate size constraints applied to field name
Annotation Email that does Invalid email format applied to field email
Annotation Min that does Validate minimum value applied to field age
```

---

## 样例11：Python装饰器

### 输入代码

```python
def timing_decorator(func):
    """Measure execution time"""
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        end = time.time()
        print(f"{func.__name__} took {end - start:.2f}s")
        return result
    return wrapper

@timing_decorator
def process_data(data):
    # processing logic
    pass
```

### 转换结果

```
Decorator Timing decorator that does Measure execution time applied to function process data
```

---

## 样例12：类方法装饰器

### 输入代码

```python
def classmethod_decorator(cls):
    """Convert method to class method"""
    return classmethod(cls)

class MyClass:
    @classmethod_decorator
    def class_method(cls):
        return cls.__name__
```

### 转换结果

```
Decorator Classmethod decorator that does Convert method to class method applied to method class method
```

---

## 转换要点

1. **装饰器名称**：规范化装饰器名称
2. **功能描述**：描述装饰器的功能
3. **应用目标**：明确装饰器应用的目标（类、方法、属性、参数）
4. **参数信息**：保留装饰器参数信息
5. **组合装饰器**：分别描述每个装饰器

## 处理策略

- **函数装饰器**：描述对函数的增强
- **类装饰器**：描述对类的修改
- **属性装饰器**：描述对属性的控制
- **参数装饰器**：描述对参数的验证
- **注解**：描述注解的用途和约束
- **组合装饰器**：分别列出每个装饰器